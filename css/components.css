/* Info Box Styles */
.info-box-wrapper {
  pointer-events: auto;
  display: flex;
  will-change: transform;
  min-width: 350px;
  height: fit-content; /* Allow wrapper to fit its content */
  max-height: calc(100% - 40px); /* Constrain wrapper height with margin */
  align-items: flex-start; /* Align items to the start of the cross axis */
  position: relative; /* Ensure relative positioning for children */
}

.info-box {
  flex: 1;
  transform-origin: left center;
  transition: transform 420ms cubic-bezier(0.25, 1, 0.5, 1);
  height: fit-content; /* Allow height to fit content */
  max-height: 100%; /* Prevent exceeding parent height */
  box-sizing: border-box; /* Include padding and border in element's total width and height */
  overflow: hidden; /* Re-add overflow hidden to clip content */
  will-change: transform;
  transform: scaleX(0);
}

.info-box-content {
  opacity: 0;
  transition: opacity 200ms ease-out;
  will-change: opacity;
  backface-visibility: hidden;
  display: flex; /* Enable flexbox for content layout */
  flex-direction: column; /* Stack content vertically */
  height: 100%; /* Take full height of parent */
  flex-grow: 1; /* Allow content to grow and take available space */
  padding: 20px; /* Add padding around content */
  overflow-y: auto; /* Enable vertical scrolling if content overflows */
  max-height: 100%; /* Prevent exceeding viewport height */
}

.visit-btn {
  align-self: flex-start;
  margin: 12px 0 2px 0;
  padding: 6px 12px;
  font-family: 'Courier New', monospace;
  font-size: 11px;
  letter-spacing: 0.08em;
  color: var(--poi-accent, #bfbfbf);
  background: rgba(0, 0, 0, 0.35);
  border: 1px solid var(--poi-accent, #666);
  border-radius: 999px;
  cursor: pointer;
  transition: transform 160ms ease, box-shadow 160ms ease, background 160ms ease;
}

.visit-btn:hover {
  background: rgba(255, 255, 255, 0.08);
  box-shadow: 0 0 12px rgba(255, 255, 255, 0.15);
  transform: translateY(-1px);
}

.visit-btn:active {
  transform: translateY(0);
}

.warp-overlay {
  position: fixed;
  inset: 0;
  pointer-events: none;
  opacity: 0;
  z-index: 2000;
  transition: opacity 200ms ease;
}

.warp-overlay.is-active {
  opacity: 1;
}

.warp-streaks,
.warp-vignette,
.warp-flash {
  position: absolute;
  inset: 0;
}

.warp-streaks {
  inset: -30%;
  opacity: 0;
  background:
    radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.35) 0%, rgba(255, 255, 255, 0.0) 60%),
    radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.0) 75%);
  filter: blur(0.8px);
  mix-blend-mode: screen;
  transform: scale(0.7);
}

.warp-vignette {
  opacity: 0;
  background: radial-gradient(circle at 50% 45%, rgba(255, 255, 255, 0.35) 0%, rgba(255, 255, 255, 0.0) 55%, rgba(0, 0, 0, 0.0) 100%);
  mix-blend-mode: screen;
}

.warp-flash {
  opacity: 0;
  background: #fff;
}

.warp-overlay.is-active .warp-streaks {
  animation: warp-streaks 2000ms cubic-bezier(0.2, 0, 0.1, 1) forwards;
}

.warp-overlay.is-active .warp-vignette {
  animation: warp-vignette 2000ms cubic-bezier(0.2, 0, 0.1, 1) forwards;
}

.warp-overlay.is-active .warp-flash {
  animation: warp-flash 2000ms cubic-bezier(0.2, 0, 0.1, 1) forwards;
}

body.warping #bg {
  animation: warp-blur 2000ms cubic-bezier(0.2, 0, 0.1, 1) forwards;
}

body.warping .css3d-header,
body.warping .css3d-footer {
  filter: brightness(1.5);
}

#bg,
.css3d-header,
.css3d-footer {
  transition: filter 200ms ease;
}

@keyframes warp-streaks {
  0% {
    opacity: 0;
    transform: scale(0.7);
  }
  35% {
    opacity: 0.3;
  }
  100% {
    opacity: 0.25;
    transform: scale(1.6);
  }
}

@keyframes warp-vignette {
  0% {
    opacity: 0;
  }
  40% {
    opacity: 0.25;
  }
  100% {
    opacity: 0.6;
  }
}

@keyframes warp-flash {
  0% {
    opacity: 0;
  }
  72% {
    opacity: 0.05;
  }
  88% {
    opacity: 0.3;
  }
  100% {
    opacity: 1;
  }
}

@keyframes warp-blur {
  0% {
    filter: brightness(1) saturate(1) blur(0px);
  }
  72% {
    filter: brightness(1.15) saturate(1.15) blur(0px);
  }
  88% {
    filter: brightness(1.35) saturate(1.25) blur(2.6px);
  }
  100% {
    filter: brightness(1.2) saturate(1.1) blur(0.4px);
  }
}
